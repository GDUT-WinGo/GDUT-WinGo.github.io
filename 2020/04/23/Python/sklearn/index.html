<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>sklearn | Wingo&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Machine Learning,sklearn">
    <meta name="description" content="ç®€å•äº†è§£æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µä»¥åŠå¸¸è§„æµç¨‹ï¼Œå¹¶ç®€å•ä»‹ç» Python çš„æœºå™¨å­¦ä¹ åº“ sklearn çš„ä½¿ç”¨ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="sklearn">
<meta property="og:url" content="http://yoursite.com/2020/04/23/Python/sklearn/index.html">
<meta property="og:site_name" content="Wingo&#39;s Blog">
<meta property="og:description" content="ç®€å•äº†è§£æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µä»¥åŠå¸¸è§„æµç¨‹ï¼Œå¹¶ç®€å•ä»‹ç» Python çš„æœºå™¨å­¦ä¹ åº“ sklearn çš„ä½¿ç”¨ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/ML01.jpg">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Flower.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/MinMax.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/StandardScore.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Table.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/CrossValidate.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/DecisionTree.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Facebook.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Facebook01.png">
<meta property="og:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Facebook02.png">
<meta property="article:published_time" content="2020-04-23T03:07:44.000Z">
<meta property="article:modified_time" content="2020-04-30T03:49:06.999Z">
<meta property="article:author" content="Wingo">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="sklearn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://welab-wingo.gitee.io/image/2020/04/SKlearn/ML01.jpg">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Wingo</h5>
          <a href="mailto:1318263468@qq.com" title="1318263468@qq.com" class="mail">1318263468@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">sklearn</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">sklearn</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-04-23T03:07:44.000Z" itemprop="datePublished" class="page-time">
  2020-04-23
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/">Python</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Jupyter-å®‰è£…é…ç½®"><span class="post-toc-number">1.</span> <span class="post-toc-text">Jupyter å®‰è£…é…ç½®</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æœºå™¨å­¦ä¹ æ¦‚è¿°"><span class="post-toc-number">2.</span> <span class="post-toc-text">æœºå™¨å­¦ä¹ æ¦‚è¿°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ•°æ®è·å–"><span class="post-toc-number">3.</span> <span class="post-toc-text">æ•°æ®è·å–</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ç‰¹å¾å·¥ç¨‹"><span class="post-toc-number">4.</span> <span class="post-toc-text">ç‰¹å¾å·¥ç¨‹</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#å­—å…¸ç‰¹å¾æå–"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">å­—å…¸ç‰¹å¾æå–</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ–‡æœ¬ç‰¹å¾æå–"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">æ–‡æœ¬ç‰¹å¾æå–</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#CountVectorizer"><span class="post-toc-number">4.2.1.</span> <span class="post-toc-text">CountVectorizer</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#TfidfVectorizer"><span class="post-toc-number">4.2.2.</span> <span class="post-toc-text">TfidfVectorizer</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç‰¹å¾é¢„å¤„ç†"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">ç‰¹å¾é¢„å¤„ç†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#å½’ä¸€åŒ–"><span class="post-toc-number">4.3.1.</span> <span class="post-toc-text">å½’ä¸€åŒ–</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#æ ‡å‡†åŒ–"><span class="post-toc-number">4.3.2.</span> <span class="post-toc-text">æ ‡å‡†åŒ–</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç‰¹å¾é™ç»´"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">ç‰¹å¾é™ç»´</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Filter"><span class="post-toc-number">4.4.1.</span> <span class="post-toc-text">Filter</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#ä¸»æˆåˆ†åˆ†æ"><span class="post-toc-number">4.4.2.</span> <span class="post-toc-text">ä¸»æˆåˆ†åˆ†æ</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ¡ˆä¾‹åˆ†æï¼šè´­ç‰©è½¦"><span class="post-toc-number">5.</span> <span class="post-toc-text">æ¡ˆä¾‹åˆ†æï¼šè´­ç‰©è½¦</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åˆ†ç±»ç®—æ³•"><span class="post-toc-number">6.</span> <span class="post-toc-text">åˆ†ç±»ç®—æ³•</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#K-è¿‘é‚»ç®—æ³•"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">K - è¿‘é‚»ç®—æ³•</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹"><span class="post-toc-number">6.1.1.</span> <span class="post-toc-text">é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#äº¤å‰éªŒè¯"><span class="post-toc-number">6.2.1.</span> <span class="post-toc-text">äº¤å‰éªŒè¯</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#ç½‘æ ¼æœç´¢"><span class="post-toc-number">6.2.2.</span> <span class="post-toc-text">ç½‘æ ¼æœç´¢</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#é¸¢å°¾èŠ±-K-å€¼è°ƒä¼˜"><span class="post-toc-number">6.2.3.</span> <span class="post-toc-text">é¸¢å°¾èŠ± K å€¼è°ƒä¼˜</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#æœ´ç´ è´å¶æ–¯"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">æœ´ç´ è´å¶æ–¯</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#å†³ç­–æ ‘"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">å†³ç­–æ ‘</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#éšæœºæ£®æ—"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">éšæœºæ£®æ—</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ¡ˆä¾‹åˆ†æï¼šç­¾åˆ°é¢„æµ‹"><span class="post-toc-number">7.</span> <span class="post-toc-text">æ¡ˆä¾‹åˆ†æï¼šç­¾åˆ°é¢„æµ‹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ¡ˆä¾‹åˆ†æï¼šç”Ÿå­˜é¢„æµ‹"><span class="post-toc-number">8.</span> <span class="post-toc-text">æ¡ˆä¾‹åˆ†æï¼šç”Ÿå­˜é¢„æµ‹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å›å½’ç®—æ³•"><span class="post-toc-number">9.</span> <span class="post-toc-text">å›å½’ç®—æ³•</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#çº¿æ€§å›å½’"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">çº¿æ€§å›å½’</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#æ­£è§„æ–¹ç¨‹"><span class="post-toc-number">9.1.1.</span> <span class="post-toc-text">æ­£è§„æ–¹ç¨‹</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#æ¢¯åº¦ä¸‹é™"><span class="post-toc-number">9.1.2.</span> <span class="post-toc-text">æ¢¯åº¦ä¸‹é™</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#å²­å›å½’"><span class="post-toc-number">9.1.3.</span> <span class="post-toc-text">å²­å›å½’</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#é€»è¾‘å›å½’"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">é€»è¾‘å›å½’</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#ç²¾ç¡®ç‡"><span class="post-toc-number">9.2.1.</span> <span class="post-toc-text">ç²¾ç¡®ç‡</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#å¬å›ç‡"><span class="post-toc-number">9.2.2.</span> <span class="post-toc-text">å¬å›ç‡</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#F1-score"><span class="post-toc-number">9.2.3.</span> <span class="post-toc-text">F1-score</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ¡ˆä¾‹åˆ†æï¼šè‚¿ç˜¤é¢„æµ‹"><span class="post-toc-number">10.</span> <span class="post-toc-text">æ¡ˆä¾‹åˆ†æï¼šè‚¿ç˜¤é¢„æµ‹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#K-means"><span class="post-toc-number">11.</span> <span class="post-toc-text">K-means</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#è´­ç‰©è½¦æ¡ˆä¾‹"><span class="post-toc-number">11.1.</span> <span class="post-toc-text">è´­ç‰©è½¦æ¡ˆä¾‹</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Python/sklearn"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">sklearn</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-04-23 11:07:44" datetime="2020-04-23T03:07:44.000Z"  itemprop="datePublished">2020-04-23</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Python/">Python</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>ç®€å•äº†è§£æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µä»¥åŠå¸¸è§„æµç¨‹ï¼Œå¹¶ç®€å•ä»‹ç» Python çš„æœºå™¨å­¦ä¹ åº“ sklearn çš„ä½¿ç”¨ã€‚</p>
<a id="more"></a>

<h3 id="Jupyter-å®‰è£…é…ç½®"><a href="#Jupyter-å®‰è£…é…ç½®" class="headerlink" title="Jupyter å®‰è£…é…ç½®"></a>Jupyter å®‰è£…é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pip3 install jupyter -i https://pypi.tuna.tsinghua.edu.cn/simple/ # å›½å†…é•œåƒä¸‹è½½ jupyter</span><br><span class="line">jupyter notebook --generate-config # ç”Ÿæˆé»˜è®¤çš„é…ç½®æ–‡ä»¶</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># Writing default config to: C:\Users\wingo\.jupyter\jupyter_notebook_config.py</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># C.NotebookApp.notebook_dir='' ä¿®æ”¹æ­¤é¡¹é…ç½®</span></span></span><br><span class="line">jupyter notebook # å¯åŠ¨ Jupyter notebook</span><br><span class="line">pip3 install -U scikit-learn -i https://pypi.tuna.tsinghua.edu.cn/simple/ # ä¸‹è½½åº“</span><br></pre></td></tr></table></figure>

<h3 id="æœºå™¨å­¦ä¹ æ¦‚è¿°"><a href="#æœºå™¨å­¦ä¹ æ¦‚è¿°" class="headerlink" title="æœºå™¨å­¦ä¹ æ¦‚è¿°"></a>æœºå™¨å­¦ä¹ æ¦‚è¿°</h3><p>æ•°æ® ğŸ‘‰ æ¨¡å‹ ğŸ‘‰ é¢„æµ‹ï¼Œå³ä»å†å²æ•°æ®ä¸­è·å¾—è§„å¾‹ã€‚</p>
<img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/ML01.jpg" style="zoom: 80%;" />

<p>æ•°æ®é›†çš„æ„æˆï¼šç‰¹å¾å€¼ + ç›®æ ‡å€¼ã€‚</p>
<blockquote>
<p>æ ¹æ®æ˜¯å¦æœ‰ç›®æ ‡å€¼ï¼Œå¯ä»¥åˆ†ä¸ºæ— ç›‘ç£å­¦ä¹ ï¼ˆæ— ç›®æ ‡å€¼ï¼‰ã€ç›‘ç£å­¦ä¹ ï¼ˆæœ‰ç›®æ ‡å€¼ï¼‰ã€‚</p>
<p>æ ¹æ®æ•°æ®çš„å½¢å¼ï¼Œå¯ä»¥åˆ†ä¸ºåˆ†ç±»é—®é¢˜ï¼ˆç±»åˆ«ï¼‰ã€å›å½’é—®é¢˜ï¼ˆè¿ç»­æ€§æ•°æ®ï¼‰ã€‚</p>
</blockquote>
<p>æœºå™¨å­¦ä¹ çš„æ™®éå¼€å‘æµç¨‹ï¼š</p>
<blockquote>
<p>1ï¼‰è·å–æ•°æ®ï¼›<br>2ï¼‰æ•°æ®å¤„ç†ï¼›<br>3ï¼‰ç‰¹å¾å·¥ç¨‹ï¼›<br>4ï¼‰æ¨¡å‹è®­ç»ƒï¼›<br>5ï¼‰æ¨¡å‹è¯„ä¼°ï¼›<br>6ï¼‰å®é™…åº”ç”¨ã€‚</p>
</blockquote>
<h3 id="æ•°æ®è·å–"><a href="#æ•°æ®è·å–" class="headerlink" title="æ•°æ®è·å–"></a>æ•°æ®è·å–</h3><p>sklearn è‡ªå¸¦äº†è®¸å¤šæ•°æ®ï¼Œä¾›å¼€å‘è€…è¿›è¡Œæµ‹è¯•ä½¿ç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥æ»¡æ»¡çš„æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="comment"># åˆ†å‰²æ•°æ®çš„æ¨¡å—ï¼ŒæŠŠæ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½½å…¥æ•°æ®ï¼Œç»å…¸é¸¢å°¾èŠ±æ•°æ®</span></span><br><span class="line">iris = datasets.load_iris()</span><br><span class="line"><span class="comment"># random_state ä¸ºäº†ä¿è¯ç¨‹åºæ¯æ¬¡è¿è¡Œéƒ½åˆ†å‰²ä¸€æ ·çš„è®­ç»ƒé›†åˆæµ‹è¯•é›†ã€‚å¦åˆ™ï¼ŒåŒæ ·çš„ç®—æ³•æ¨¡å‹åœ¨ä¸åŒçš„è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„æ•ˆæœä¸ä¸€æ ·ã€‚</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, test_size=<span class="number">0.2</span>, random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ­¤æ•°æ®é›†çš„è¯¦ç»†æè¿°ï¼š</p>
<img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Flower.png" style="zoom:80%;" />

<p>æ•°æ®é›†çš„åˆ’åˆ†ï¼š</p>
<blockquote>
<p>è®­ç»ƒæ•°æ®ï¼Œç”¨äºè®­ç»ƒï¼Œæ„å»ºæ¨¡å‹ï¼›<br>æµ‹è¯•æ•°æ®ï¼Œåœ¨æ¨¡å‹æ£€éªŒæ—¶ä½¿ç”¨ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹æ˜¯å¦æœ‰æ•ˆã€‚</p>
</blockquote>
<h3 id="ç‰¹å¾å·¥ç¨‹"><a href="#ç‰¹å¾å·¥ç¨‹" class="headerlink" title="ç‰¹å¾å·¥ç¨‹"></a>ç‰¹å¾å·¥ç¨‹</h3><blockquote>
<p>Feature Engineeringï¼šç‰¹å¾å·¥ç¨‹å°±æ˜¯å¯¹ç‰¹å¾å€¼è¿›è¡Œå¤„ç†ï¼Œé€‰æ‹©æœ‰æ„ä¹‰çš„ç‰¹å¾è¾“å…¥æœºå™¨å­¦ä¹ çš„ç®—æ³•å’Œæ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚</p>
</blockquote>
<h4 id="å­—å…¸ç‰¹å¾æå–"><a href="#å­—å…¸ç‰¹å¾æå–" class="headerlink" title="å­—å…¸ç‰¹å¾æå–"></a>å­—å…¸ç‰¹å¾æå–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction <span class="keyword">import</span> DictVectorizer</span><br><span class="line"></span><br><span class="line"><span class="comment"># list:[dict&#123;&#125;, dict&#123;&#125;, dict&#123;&#125;]</span></span><br><span class="line">data = [&#123;<span class="string">'city'</span>: <span class="string">'åŒ—äº¬'</span>,<span class="string">'temperature'</span>:<span class="number">100</span>&#125;, &#123;<span class="string">'city'</span>: <span class="string">'ä¸Šæµ·'</span>,<span class="string">'temperature'</span>:<span class="number">60</span>&#125;, &#123;<span class="string">'city'</span>: <span class="string">'æ·±åœ³'</span>,<span class="string">'temperature'</span>:<span class="number">30</span>&#125;]</span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ä¸€ä¸ªè½¬æ¢å™¨ç±»ï¼Œæ­¤å¤„ sparse=True è®¾ç½®ç»“æœä¸ºç¨€ç–çŸ©é˜µæ–¹ä¾¿æŸ¥çœ‹</span></span><br><span class="line">transfer = DictVectorizer(sparse=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># è°ƒç”¨ fit_transform() è¿›è¡Œç‰¹å¾æå–</span></span><br><span class="line">data_new = transfer.fit_transform(data)</span><br><span class="line"><span class="comment"># æ‰“å°ç‰¹å¾æå–ç»“æœ</span></span><br><span class="line">print(<span class="string">"data_new_sparse:\n"</span>, data_new, <span class="string">"\n"</span>, type(data_new))</span><br><span class="line">print(<span class="string">"data_new:\n"</span>, data_new.toarray())</span><br><span class="line">print(<span class="string">"ç‰¹å¾åå­—:\n"</span>, transfer.get_feature_names())</span><br><span class="line"><span class="string">""" æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="string">data_new_sparse:</span></span><br><span class="line"><span class="string">  (0, 1)	1.0</span></span><br><span class="line"><span class="string">  (0, 3)	100.0</span></span><br><span class="line"><span class="string">  (1, 0)	1.0</span></span><br><span class="line"><span class="string">  (1, 3)	60.0</span></span><br><span class="line"><span class="string">  (2, 2)	1.0</span></span><br><span class="line"><span class="string">  (2, 3)	30.0 </span></span><br><span class="line"><span class="string"> &lt;class 'scipy.sparse.csr.csr_matrix'&gt;</span></span><br><span class="line"><span class="string">data_new:</span></span><br><span class="line"><span class="string"> [[  0.   1.   0. 100.]</span></span><br><span class="line"><span class="string"> [  1.   0.   0.  60.]</span></span><br><span class="line"><span class="string"> [  0.   0.   1.  30.]]</span></span><br><span class="line"><span class="string">ç‰¹å¾åå­—:</span></span><br><span class="line"><span class="string"> ['city=ä¸Šæµ·', 'city=åŒ—äº¬', 'city=æ·±åœ³', 'temperature']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<p>ç”±ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œç»è¿‡ sklearn çš„å­—å…¸ç‰¹å¾è½¬æ¢åï¼Œå…¶ç±»å‹è½¬æ¢ä¸º matrixï¼Œå³ä¸€ä¸ªçŸ©é˜µç±»å‹ã€‚</p>
<p>åŸå§‹æ•°æ®ä¸­çš„ç‰¹å¾å€¼åªæœ‰ 2 ä¸ªï¼šcityã€temperatureï¼›ä½†è½¬æ¢å‡ºæ¥çš„ç‰¹å¾çŸ©é˜µå´æœ‰ 4 åˆ—ï¼Œè¿™æ˜¯ä¸ºäº†å°†ç‰¹å¾å€¼å˜é‡è½¬æ¢ä¸ºæœºå™¨å­¦ä¹ ç®—æ³•æ˜“äºåˆ©ç”¨çš„ä¸€ç§å½¢å¼ï¼Œæ­¤è½¬æ¢è¿‡ç¨‹ç§°ä¸º <strong>one hot ç¼–ç </strong>ã€‚</p>
<h4 id="æ–‡æœ¬ç‰¹å¾æå–"><a href="#æ–‡æœ¬ç‰¹å¾æå–" class="headerlink" title="æ–‡æœ¬ç‰¹å¾æå–"></a>æ–‡æœ¬ç‰¹å¾æå–</h4><h5 id="CountVectorizer"><a href="#CountVectorizer" class="headerlink" title="CountVectorizer"></a>CountVectorizer</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</span><br><span class="line">data = [<span class="string">"How to shift your mindset and choose your future"</span>, <span class="string">"I like python, Do you like python?"</span>]</span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ä¸€ä¸ªè½¬æ¢å™¨ç±»ï¼Œå¯ä»¥å±è”½ä¸€äº›æ²¡æœ‰æ„ä¹‰çš„è¯è¯­</span></span><br><span class="line">transfer = CountVectorizer(stop_words=[<span class="string">"and"</span>, <span class="string">"to"</span>])</span><br><span class="line"><span class="comment"># è°ƒç”¨ fit_transform</span></span><br><span class="line">data_new = transfer.fit_transform(data)</span><br><span class="line">print(<span class="string">"data_new:\n"</span>, data_new.toarray())</span><br><span class="line">print(<span class="string">"ç‰¹å¾åå­—ï¼š\n"</span>, transfer.get_feature_names())</span><br><span class="line"><span class="string">""" æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="string">data_new:</span></span><br><span class="line"><span class="string"> [[1 0 1 1 0 1 0 1 0 2]</span></span><br><span class="line"><span class="string"> [0 1 0 0 2 0 2 0 1 0]]</span></span><br><span class="line"><span class="string">ç‰¹å¾åå­—ï¼š</span></span><br><span class="line"><span class="string"> ['choose', 'do', 'future', 'how', 'like', 'mindset', 'python', 'shift', 'you', 'your']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<p>æ€è€ƒï¼šè‹¥æ˜¯å¯¹ä¸€å¥ä¸­æ–‡æ–‡æœ¬è¿›è¡Œæ–‡æœ¬ç‰¹å¾æå–ï¼Œé‚£ä¼šå‡ºç°ä»€ä¹ˆç»“æœï¼Ÿ</p>
<blockquote>
<p>å¯¹äºä¸­æ–‡æ–‡æœ¬ï¼Œå› ä¸ºè¯è¯­ä¹‹é—´ä¸å­˜åœ¨ç©ºæ ¼ï¼Œæ‰€ä»¥éœ€è¦åˆ†è¯åº“å…ˆè¿›è¡Œåˆ†è¯ï¼š<code>&quot; &quot;.join(list(jieba.cut(text)))</code></p>
</blockquote>
<h5 id="TfidfVectorizer"><a href="#TfidfVectorizer" class="headerlink" title="TfidfVectorizer"></a>TfidfVectorizer</h5><blockquote>
<p>Term Frequency - Inverse Document Frequencyï¼Œå³è¯é¢‘ - é€†æ–‡æœ¬é¢‘ç‡ï¼Œç”± TF å’Œ IDF ç»„æˆã€‚</p>
<p>TFï¼Œå³æ™®é€šçš„è¯é¢‘ç»Ÿè®¡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œ<br>IDFï¼Œç”¨äºååº”ä¸€ä¸ªè¯çš„é‡è¦æ€§ï¼Œè¿›è€Œä¿®æ­£ä»…ä»…ç”¨è¯é¢‘è¡¨ç¤ºçš„è¯ç‰¹å¾å€¼ã€‚æ¯”å¦‚ï¼Œâ€toâ€ è¿™ä¸ªè¯çš„è¯é¢‘éå¸¸é«˜ï¼Œä½†å®ƒåœ¨æ¯ä¸€ç¯‡æ–‡ç« ä¸­éƒ½å‡ºç°äº†ï¼Œé‚£ä¹ˆå®ƒè¿™ä¸ªé«˜è¯é¢‘å°±æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„æ„ä¹‰ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfVectorizer</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line">data = [<span class="string">"ä»Šå¤©æ˜¯æ˜ŸæœŸä¸€ï¼Œæœ‰ç‚¹å¿«ä¹"</span>, <span class="string">"ä»Šå¤©æ˜¯æ˜ŸæœŸäºŒï¼Œæ— æ•Œå¿«ä¹"</span>, <span class="string">"ä»Šå¤©æ˜¯æ˜ŸæœŸä¸‰ï¼Œè¶…çº§å¿«ä¹"</span>]</span><br><span class="line">data_new = []</span><br><span class="line"><span class="keyword">for</span> sent <span class="keyword">in</span> data:</span><br><span class="line">    data_new.append(<span class="string">" "</span>.join(list(jieba.cut(sent))))</span><br><span class="line"><span class="string">"""data_new</span></span><br><span class="line"><span class="string">['ä»Šå¤© æ˜¯ æ˜ŸæœŸä¸€ ï¼Œ æœ‰ç‚¹ å¿«ä¹', 'ä»Šå¤© æ˜¯ æ˜ŸæœŸäºŒ ï¼Œ æ— æ•Œ å¿«ä¹', 'ä»Šå¤© æ˜¯ æ˜ŸæœŸä¸‰ ï¼Œ è¶…çº§ å¿«ä¹']</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># è½¬æ¢å™¨</span></span><br><span class="line">transfer = TfidfVectorizer()</span><br><span class="line">transfer_normal = CountVectorizer()</span><br><span class="line"><span class="comment"># ç‰¹å¾æå–</span></span><br><span class="line">data_final = transfer.fit_transform(data_new)</span><br><span class="line">data_normal = transfer_normal.fit_transform(data_new)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"data_new:\n"</span>, data_final.toarray())</span><br><span class="line">print(<span class="string">"data_new_normal:\n"</span>, data_normal.toarray())</span><br><span class="line">print(<span class="string">"ç‰¹å¾åå­—ï¼š\n"</span>, transfer.get_feature_names())</span><br><span class="line"><span class="string">"""æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="string">data_new:</span></span><br><span class="line"><span class="string"> [[0.35959372 0.35959372 0.         0.6088451  0.         0.</span></span><br><span class="line"><span class="string">  0.6088451  0.        ]</span></span><br><span class="line"><span class="string"> [0.35959372 0.35959372 0.6088451  0.         0.         0.6088451</span></span><br><span class="line"><span class="string">  0.         0.        ]</span></span><br><span class="line"><span class="string"> [0.35959372 0.35959372 0.         0.         0.6088451  0.</span></span><br><span class="line"><span class="string">  0.         0.6088451 ]]</span></span><br><span class="line"><span class="string">data_new_normal:</span></span><br><span class="line"><span class="string"> [[1 1 0 1 0 0 1 0]</span></span><br><span class="line"><span class="string"> [1 1 1 0 0 1 0 0]</span></span><br><span class="line"><span class="string"> [1 1 0 0 1 0 0 1]]</span></span><br><span class="line"><span class="string">ç‰¹å¾åå­—ï¼š</span></span><br><span class="line"><span class="string"> ['ä»Šå¤©', 'å¿«ä¹', 'æ— æ•Œ', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸäºŒ', 'æœ‰ç‚¹', 'è¶…çº§']</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ†æä¸Šè¿°ç»“æœï¼Œæ™®é€šçš„è¯é¢‘åˆ†æå¾—å‡ºçš„ç»“æœæ˜¯è¯é¢‘ç›¸åŒï¼Œè€Œ tf-idf åˆ†æï¼Œå¯¹äºæ¯ä¸ªå¥å­ä¸­éƒ½å‡ºç°çš„è¯çš„é‡è¦æ€§ä¼šæœ‰æ‰€é™ä½ã€‚</p>
</blockquote>
<h4 id="ç‰¹å¾é¢„å¤„ç†"><a href="#ç‰¹å¾é¢„å¤„ç†" class="headerlink" title="ç‰¹å¾é¢„å¤„ç†"></a>ç‰¹å¾é¢„å¤„ç†</h4><blockquote>
<p>æ— é‡çº²åŒ–ï¼šè¿›è¡Œæ— é‡çº²åŒ–åè¡¨å¾ä¸åŒå±æ€§ï¼ˆå•ä½ä¸åŒï¼‰çš„å„ç‰¹å¾ä¹‹é—´æ‰æœ‰å¯æ¯”æ€§ï¼Œå¦‚ 1cm ä¸ 0.1kg å¦‚ä½•æ¯”è¾ƒï¼Ÿ</p>
</blockquote>
<h5 id="å½’ä¸€åŒ–"><a href="#å½’ä¸€åŒ–" class="headerlink" title="å½’ä¸€åŒ–"></a>å½’ä¸€åŒ–</h5><blockquote>
<p>æ— æ³•å¤„ç†å¼‚å¸¸å€¼ï¼ˆæœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼‰ï¼›</p>
</blockquote>
<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/MinMax.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"></span><br><span class="line">x_mm = [[<span class="number">1</span>,<span class="number">-1</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>]]</span><br><span class="line">x_mm_new = MinMaxScaler().fit_transform(x_mm)</span><br><span class="line"><span class="string">"""x_mm_new</span></span><br><span class="line"><span class="string">array([[0.5       , 0.        , 1.        ],</span></span><br><span class="line"><span class="string">       [1.        , 0.5       , 0.33333333],</span></span><br><span class="line"><span class="string">       [0.        , 1.        , 0.        ]])</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<h5 id="æ ‡å‡†åŒ–"><a href="#æ ‡å‡†åŒ–" class="headerlink" title="æ ‡å‡†åŒ–"></a>æ ‡å‡†åŒ–</h5><blockquote>
<p>æ ‡å‡†å·®ï¼ˆæè¿°æ ·æœ¬é›†ä¸­ç¨‹åº¦ï¼Œå¼‚å¸¸å€¼å¯¹æ€»æ ·æœ¬çš„é›†ä¸­ç¨‹åº¦çš„å½±å“ä¸å¤§ï¼‰ï¼Œåœ¨å·²æœ‰æ ·æœ¬è¶³å¤Ÿå¤šçš„æƒ…å†µä¸‹æ¯”è¾ƒç¨³å®šï¼Œé€‚åˆç°ä»£å˜ˆæ‚å¤§æ•°æ®åœºæ™¯ã€‚</p>
</blockquote>
<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/StandardScore.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">x = [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>]]</span><br><span class="line">x_new = StandardScaler().fit_transform(x)</span><br><span class="line"><span class="string">"""x_new</span></span><br><span class="line"><span class="string">array([[-0.70710678, -0.70710678, -0.16222142],</span></span><br><span class="line"><span class="string">       [ 1.41421356,  1.41421356,  1.29777137],</span></span><br><span class="line"><span class="string">       [-0.70710678, -0.70710678, -1.13554995]])</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<h4 id="ç‰¹å¾é™ç»´"><a href="#ç‰¹å¾é™ç»´" class="headerlink" title="ç‰¹å¾é™ç»´"></a>ç‰¹å¾é™ç»´</h4><blockquote>
<p>è¿™é‡Œçš„é™ç»´çš„ç»´åº¦ï¼Œä¸æ˜¯æŒ‡çŸ©é˜µã€å‘é‡ã€æ ‡é‡ç­‰ï¼Œè€Œæ˜¯æŒ‡é™ä½ç‰¹å¾çš„ä¸ªæ•°ï¼Œè®©æœ€ç»ˆå¾—åˆ°çš„æ•°æ®ä¸­çš„æ¯ä¸ªç‰¹å¾ä¹‹é—´äº’ä¸ç›¸å…³ã€‚</p>
</blockquote>
<p>æ€è€ƒï¼šç‰¹å¾ä¹‹é—´ç›¸å…³åº¦è¿‡é«˜ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿï¼Ÿï¼Ÿè‹¥ mã€n éƒ½å¯ä»¥å¾—å‡º rï¼Œé‚£ä¹ˆå»æ‰ m ã€n ä¸­çš„ä»»æ„ä¸€ä¸ªç‰¹å¾å¯¹ç»“æœéƒ½ä¸ä¼šå½±å“ï¼Œåœ¨ä¸€ä¸ªåºå¤§çš„æ•°æ®ä¸­ï¼Œå»æ‰æŸäº›ç›¸å…³æ€§ç‰¹åˆ«é«˜çš„ç‰¹å¾å¯ä»¥èŠ‚çœå¾ˆå¤šç®—åŠ›ä¸å†…å­˜ç©ºé—´ï¼Œæ¨¡å‹æ›´åŠ é«˜æ•ˆã€‚</p>
<h5 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h5><blockquote>
<p>æ–¹å·®é€‰æ‹©æ³•ï¼šä½æ–¹å·®ç‰¹å¾è¿‡æ»¤ï¼Œå³è¿‡æ»¤å·®åˆ«ä¸å¤§çš„ç‰¹å¾ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> VarianceThreshold</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> pearsonr</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">data = pd.read_csv(<span class="string">"factor_returns.csv"</span>)</span><br><span class="line"><span class="comment"># ä¿ç•™æ¯ä¸€è¡Œï¼Œä¿ç•™ä»[ç¬¬äºŒåˆ—åˆ°å€’æ•°ç¬¬äºŒåˆ—)</span></span><br><span class="line">data = data.iloc[:, <span class="number">1</span>:<span class="number">-2</span>]</span><br><span class="line">data_v = data.values</span><br><span class="line">print(<span class="string">"data:\n"</span>, data_v.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ä¸€ä¸ªè½¬æ¢å™¨ç±»</span></span><br><span class="line">transfer = VarianceThreshold(threshold=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ fit_transform</span></span><br><span class="line">data_new = transfer.fit_transform(data)</span><br><span class="line">print(<span class="string">"data_new:\n"</span>,data_new.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æŸä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³ç³»æ•°</span></span><br><span class="line">r1 = pearsonr(data[<span class="string">"pe_ratio"</span>], data[<span class="string">"pb_ratio"</span>])</span><br><span class="line">print(<span class="string">"pe_ratio ä¸ pb_ratio ä¹‹é—´çš„ç›¸å…³æ€§ï¼š\n"</span>, r1)</span><br><span class="line">r2 = pearsonr(data[<span class="string">'revenue'</span>], data[<span class="string">'total_expense'</span>])</span><br><span class="line">print(<span class="string">"revenue ä¸ total_expense ä¹‹é—´çš„ç›¸å…³æ€§ï¼š\n"</span>, r2)</span><br><span class="line"></span><br><span class="line"><span class="string">"""æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="string">data:</span></span><br><span class="line"><span class="string"> (2318, 9)</span></span><br><span class="line"><span class="string">data_new:</span></span><br><span class="line"><span class="string"> (2318, 7)</span></span><br><span class="line"><span class="string">pe_ratio ä¸ pb_ratio ä¹‹é—´çš„ç›¸å…³æ€§ï¼š</span></span><br><span class="line"><span class="string"> (-0.0043893227799362685, 0.8327205496564927)</span></span><br><span class="line"><span class="string">revenue ä¸ total_expense ä¹‹é—´çš„ç›¸å…³æ€§ï¼š</span></span><br><span class="line"><span class="string"> (0.9958450413136116, 0.0)</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>pearsonrï¼šçš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œå–å€¼èŒƒå›´ï¼šâ€“1â‰¤ r â‰¤+1ã€‚</p>
</blockquote>
<p>è‹¥ç‰¹å¾ä¸ç‰¹å¾ä¹‹é—´ç›¸å…³æ€§å¾ˆé«˜ï¼š</p>
<blockquote>
<p>é€‰å–å…¶ä¸­ä¸€ä¸ªï¼›<br>åŠ æƒæ±‚å’Œï¼›<br>ä¸»æˆåˆ†åˆ†æï¼›</p>
</blockquote>
<h5 id="ä¸»æˆåˆ†åˆ†æ"><a href="#ä¸»æˆåˆ†åˆ†æ" class="headerlink" title="ä¸»æˆåˆ†åˆ†æ"></a>ä¸»æˆåˆ†åˆ†æ</h5><blockquote>
<p>PCAï¼ŒPrincipal components analysisã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transfer = PCA(n_components=<span class="number">0.95</span>) <span class="comment"># è¿›è¡Œ PCA é™ç»´ï¼Œå¹¶ä¿å­˜ 95% çš„ä¿¡æ¯ã€‚</span></span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹åˆ†æï¼šè´­ç‰©è½¦"><a href="#æ¡ˆä¾‹åˆ†æï¼šè´­ç‰©è½¦" class="headerlink" title="æ¡ˆä¾‹åˆ†æï¼šè´­ç‰©è½¦"></a>æ¡ˆä¾‹åˆ†æï¼šè´­ç‰©è½¦</h3><blockquote>
<p>é¢„æµ‹æŸä¸ª user_id ä¸‹æ¬¡ä¼šè´­ä¹° aisleã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line"><span class="comment"># è®¢å•ä¸å•†å“ä¿¡æ¯</span></span><br><span class="line">order_products = pd.read_csv(<span class="string">"./instacart/order_products__prior.csv"</span>)</span><br><span class="line"><span class="comment"># å•†å“è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">products = pd.read_csv(<span class="string">"./instacart/products.csv"</span>)</span><br><span class="line"><span class="comment"># è®¢å•è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">orders = pd.read_csv(<span class="string">"./instacart/orders.csv"</span>)</span><br><span class="line"><span class="comment"># å•†å“æ‰€å±ç±»åˆ«ä¿¡æ¯</span></span><br><span class="line">aisles = pd.read_csv(<span class="string">"./instacart/aisles.csv"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°ç‰¹å¾å€¼æ‰¾è§„å¾‹ï¼Œå°†æ‰€æœ‰çš„ç‰¹å¾å€¼åˆå¹¶åˆ°ä¸€å¼ è¡¨ä¸­ç„¶åè¿›è¡Œ PCA é™ç»´</span></span><br><span class="line">print(order_products.columns.values.tolist(),<span class="string">"\n"</span>, products.columns.values.tolist(),</span><br><span class="line">      <span class="string">"\n"</span>, orders.columns.values.tolist(),<span class="string">"\n"</span>, aisles.columns.values.tolist())</span><br><span class="line"></span><br><span class="line"><span class="string">"""æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="string">['order_id', 'product_id', 'add_to_cart_order', 'reordered'] </span></span><br><span class="line"><span class="string">['product_id', 'product_name', 'aisle_id', 'department_id'] </span></span><br><span class="line"><span class="string">['order_id', 'user_id', 'eval_set', 'order_number', 'order_dow', 'order_hour_of_day', 'days_since_prior_order'] </span></span><br><span class="line"><span class="string">['aisle_id', 'aisle']</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">tab1 = pd.merge(aisles, products, on=[<span class="string">"aisle_id"</span>, <span class="string">"aisle_id"</span>])</span><br><span class="line">tab2 = pd.merge(tab1, order_products, on=[<span class="string">"product_id"</span>, <span class="string">"product_id"</span>])</span><br><span class="line">tab3 = pd.merge(tab2, orders, on=[<span class="string">"order_id"</span>, <span class="string">"order_id"</span>])</span><br><span class="line">tab3.columns.values.tolist()</span><br><span class="line"></span><br><span class="line"><span class="string">"""æ‰“å°ç»“æœ</span></span><br><span class="line"><span class="string">['aisle_id', 'aisle', 'product_id', 'product_name', 'department_id', </span></span><br><span class="line"><span class="string">'order_id', 'add_to_cart_order', 'reordered', 'user_id', 'eval_set', </span></span><br><span class="line"><span class="string">'order_number', 'order_dow', 'order_hour_of_day', 'days_since_prior_order']</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># è™½ç„¶æ‰€æœ‰çš„æ•°æ®ç‰¹å¾éƒ½åœ¨ä¸€ä¸ªè¡¨ä¸­ï¼Œä½†è¡¨çš„å½¢å¼ä¸æ˜¯éœ€è¦çš„ user_id ä¸ aisle çš„å…³ç³»</span></span><br><span class="line"><span class="comment"># åˆ©ç”¨äº¤å‰è¡¨åæ˜ çš„ user_id å’Œ aisle ä¹‹é—´çš„å…³ç³»</span></span><br><span class="line">table = pd.crosstab(tab3[<span class="string">"user_id"</span>], tab3[<span class="string">"aisle"</span>])</span><br></pre></td></tr></table></figure>

<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Table.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ‰å¤§é‡çš„ç‰¹å¾å€¼ï¼Œå¯¹æ•°æ®è¿›è¡Œé™ç»´å¤„ç†</span></span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line">data = table[:<span class="number">10000</span>]</span><br><span class="line">data.shape</span><br><span class="line"><span class="comment"># (10000, 134)</span></span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line"><span class="comment"># å®ä¾‹åŒ–ä¸€ä¸ªè½¬æ¢å™¨ç±»</span></span><br><span class="line">transfer = PCA(n_components=<span class="number">0.95</span>)</span><br><span class="line"><span class="comment"># è°ƒç”¨ fit_transform</span></span><br><span class="line">data_new = transfer.fit_transform(data)</span><br><span class="line">data_new.shape</span><br><span class="line"><span class="comment"># (10000, 42)</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨ä¸Šè¿°æ¡ˆä¾‹ä¸­ï¼Œé€šè¿‡ PCA é™ç»´ï¼Œå°† 134 ä¸ªç‰¹å¾å€¼é™åˆ°äº† 42 ä¸ªï¼Œå¹¶ä¸”è¿˜ä¿ç•™äº†åŸæœ¬æ•°æ® 95% çš„ä¿¡æ¯ï¼Œå¯è§ PCA é™ç»´è¿˜æ˜¯æŒºå¥½ç”¨çš„ã€‚</p>
</blockquote>
<h3 id="åˆ†ç±»ç®—æ³•"><a href="#åˆ†ç±»ç®—æ³•" class="headerlink" title="åˆ†ç±»ç®—æ³•"></a>åˆ†ç±»ç®—æ³•</h3><p>sklearn çš„è½¬æ¢å™¨å’Œä¼°è®¡å™¨ã€‚</p>
<p>è½¬æ¢å™¨ï¼ˆtransformerï¼‰ï¼Œç‰¹å¾å·¥ç¨‹çš„çˆ¶ç±»ï¼›</p>
<blockquote>
<p>fit_transform() å…¶å®æ˜¯ä¸¤ä¸ªè¿‡ç¨‹ï¼šfit() è®¡ç®—æ¯ä¸€åˆ—çš„å¹³å‡å€¼ã€æ ‡å‡†å·®ï¼›transform() å®ç°æœ€ç»ˆçš„è½¬æ¢ã€‚</p>
</blockquote>
<p>ä¼°è®¡å™¨ï¼ˆestimatorï¼‰ï¼Œæœºå™¨å­¦ä¹ ç®—æ³•çš„å®ç°ã€‚</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">estimator.fit(x_train, y_train) <span class="comment"># è®¡ç®—ç”Ÿæˆæ¨¡å‹</span></span><br><span class="line">y_predict = estimator.predict(x_test) <span class="comment"># å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œæµ‹è¯•</span></span><br><span class="line">y_test == y_predict <span class="comment"># æµ‹è¯•ç»“æœä¸åŸæœ‰ç»“æœè¿›è¡Œå¯¹æ¯”</span></span><br><span class="line">accuracy = estimator.score(x_test, y_test) <span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="K-è¿‘é‚»ç®—æ³•"><a href="#K-è¿‘é‚»ç®—æ³•" class="headerlink" title="K - è¿‘é‚»ç®—æ³•"></a>K - è¿‘é‚»ç®—æ³•</h4><blockquote>
<p>å³ï¼Œæ ¹æ®é‚»è¿‘çš„ç±»å‹æ¥æ¨æµ‹å‡ºè‡ªèº«ç±»å‹ã€‚é‚»è¿‘æŒ‡çš„æ˜¯è·ç¦»ï¼š æ¬§æ°è·ç¦»ï¼›æ›¼å“ˆé¡¿è·ç¦»ï¼ˆç»å¯¹å€¼è·ç¦»ï¼‰ï¼Œæ˜å¯å¤«æ–¯åŸºè·ç¦»ã€‚</p>
</blockquote>
<h5 id="é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹"><a href="#é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹" class="headerlink" title="é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹"></a>é¸¢å°¾èŠ±åˆ†ç±»æ¡ˆä¾‹</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">iris = load_iris()</span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‰¹å¾å·¥ç¨‹</span></span><br><span class="line">transfer = StandardScaler()</span><br><span class="line"><span class="comment"># è®­ç»ƒé›†å’Œæµ‹è¯•é›†éƒ½è¦åšä¸€æ ·çš„å¤„ç†</span></span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line"><span class="comment"># æµ‹è¯•åŸºä½¿ç”¨æµ‹è¯•æœºçš„ fit() è¿›è¡Œè®¡ç®—</span></span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># KNN ç®—æ³•é¢„ä¼°å™¨ï¼Œè‡ªå®šä¹‰è·ç¦»ï¼ˆä¸æ–­å°è¯•å‡ºä¸€ä¸ªå‡†ç¡®ç‡è¾ƒé«˜çš„è·ç¦»ï¼‰</span></span><br><span class="line">estimator = KNeighborsClassifier(n_neighbors=<span class="number">3</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"y_predict:\n"</span>, y_predict)</span><br><span class="line">print(<span class="string">"ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n"</span>, y_test == y_predict)</span><br><span class="line"><span class="string">"""ç»“æœæ‰“å°</span></span><br><span class="line"><span class="string">y_predict:</span></span><br><span class="line"><span class="string"> [2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1 0</span></span><br><span class="line"><span class="string"> 2]</span></span><br><span class="line"><span class="string">ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:</span></span><br><span class="line"><span class="string"> [ True  True  True  True  True  True  True  True  True  True  True  True</span></span><br><span class="line"><span class="string">  True  True  True  True  True  True  True  True  True  True  True  True</span></span><br><span class="line"><span class="string">  True  True  True  True  True  True  True  True  True  True  True  True</span></span><br><span class="line"><span class="string">  True False]</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">score = estimator.score(x_test, y_test)</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š\n"</span>, score)</span><br><span class="line"><span class="string">"""ç»“æœæ‰“å°</span></span><br><span class="line"><span class="string">å‡†ç¡®ç‡ä¸ºï¼š</span></span><br><span class="line"><span class="string"> 0.9736842105263158</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¼˜ç‚¹ï¼šç®€å•ï¼Œæ˜“äºç†è§£ï¼Œæ˜“äºå®ç°ï¼Œæ— éœ€è®­ç»ƒ;<br>ç¼ºç‚¹ï¼šå¿…é¡»æŒ‡å®š K å€¼ï¼ŒK å€¼é€‰æ‹©ä¸å½“åˆ™åˆ†ç±»ç²¾åº¦ä¸èƒ½ä¿è¯ï¼›æ‡’æƒ°ç®—æ³•ï¼Œå¯¹æµ‹è¯•æ ·æœ¬åˆ†ç±»æ—¶çš„è®¡ç®—é‡å¤§ï¼Œå†…å­˜å¼€é”€å¤§ï¼›<br>ä½¿ç”¨åœºæ™¯ï¼šå°æ•°æ®åœºæ™¯ï¼Œå‡ åƒï½å‡ ä¸‡æ ·æœ¬ï¼Œå…·ä½“åœºæ™¯å…·ä½“ä¸šåŠ¡å»æµ‹è¯•ã€‚</p>
</blockquote>
<h4 id="æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"><a href="#æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜" class="headerlink" title="æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜"></a>æ¨¡å‹é€‰æ‹©ä¸è°ƒä¼˜</h4><blockquote>
<p>æœ‰æ—¶å€™å¾—åˆ°çš„æ¨¡å‹çš„å‡†ç¡®ç‡ä¸å°½äººæ„ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨æŸäº›ç®—æ³•å¯¹æ¨¡å‹è¿›è¡Œé€‰æ‹©å’Œè°ƒä¼˜äº†ã€‚</p>
</blockquote>
<h5 id="äº¤å‰éªŒè¯"><a href="#äº¤å‰éªŒè¯" class="headerlink" title="äº¤å‰éªŒè¯"></a>äº¤å‰éªŒè¯</h5><blockquote>
<p>éªŒè¯é›†çš„æ•°é‡ä¸å¤Ÿï¼Œé‚£ä¹ˆæœ€å¥½è¿˜æ˜¯ç”¨äº¤å‰éªŒè¯å§ã€‚è‡³äºåˆ†æˆå‡ ä»½æ¯”è¾ƒå¥½ï¼Œä¸€èˆ¬éƒ½æ˜¯åˆ†æˆ 3ã€5 å’Œ 10 ä»½ã€‚</p>
</blockquote>
<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/CrossValidate.png" alt=""></p>
<h5 id="ç½‘æ ¼æœç´¢"><a href="#ç½‘æ ¼æœç´¢" class="headerlink" title="ç½‘æ ¼æœç´¢"></a>ç½‘æ ¼æœç´¢</h5><blockquote>
<p>åˆç§°ä¸ºè¶…å‚æ•°æœç´¢ã€‚å¯¹ KNN çš„ K å€¼è¿›è¡Œå‚æ•°è°ƒä¼˜ï¼ŒæŠŠä¸€ç»„ K å€¼ä¼ å…¥ç½‘æ ¼æœç´¢ä¸­ï¼Œæ‰¾å‡ºæœ€ä¼˜å€¼ã€‚</p>
</blockquote>
<h5 id="é¸¢å°¾èŠ±-K-å€¼è°ƒä¼˜"><a href="#é¸¢å°¾èŠ±-K-å€¼è°ƒä¼˜" class="headerlink" title="é¸¢å°¾èŠ± K å€¼è°ƒä¼˜"></a>é¸¢å°¾èŠ± K å€¼è°ƒä¼˜</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">estimator = KNeighborsClassifier()</span><br><span class="line"><span class="comment"># åŠ å…¥ç½‘æ ¼æœç´¢ä¸äº¤å‰éªŒè¯</span></span><br><span class="line"><span class="comment"># å‚æ•°å‡†å¤‡</span></span><br><span class="line">param_dict = &#123;<span class="string">"n_neighbors"</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>]&#125;</span><br><span class="line"><span class="comment"># cv=10ï¼Œè¿›è¡Œ10æŠ˜äº¤å‰éªŒè¯</span></span><br><span class="line">estimator = GridSearchCV(estimator, param_grid=param_dict, cv=<span class="number">10</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"y_predict:\n"</span>, y_predict)</span><br><span class="line">print(<span class="string">"ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n"</span>, y_test == y_predict)</span><br><span class="line">score = estimator.score(x_test, y_test)</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š\n"</span>, score)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€ä½³å‚æ•°ï¼šbest_params_</span></span><br><span class="line">print(<span class="string">"æœ€ä½³å‚æ•°ï¼š\n"</span>, estimator.best_params_)</span><br><span class="line"><span class="comment"># æœ€ä½³ç»“æœï¼šbest_score_</span></span><br><span class="line">print(<span class="string">"æœ€ä½³ç»“æœï¼š\n"</span>, estimator.best_score_)</span><br><span class="line"><span class="comment"># æœ€ä½³ä¼°è®¡å™¨ï¼šbest_estimator_</span></span><br><span class="line">print(<span class="string">"æœ€ä½³ä¼°è®¡å™¨:\n"</span>, estimator.best_estimator_)</span><br><span class="line"><span class="comment"># äº¤å‰éªŒè¯ç»“æœï¼šcv_results_</span></span><br><span class="line">print(<span class="string">"äº¤å‰éªŒè¯ç»“æœ:\n"</span>, estimator.cv_results_)</span><br></pre></td></tr></table></figure>

<h4 id="æœ´ç´ è´å¶æ–¯"><a href="#æœ´ç´ è´å¶æ–¯" class="headerlink" title="æœ´ç´ è´å¶æ–¯"></a>æœ´ç´ è´å¶æ–¯</h4><blockquote>
<p>Naive Bayesianã€‚æœ´ç´ ï¼Ÿå³ï¼Œå‡è®¾ç‰¹å¾ä¸ç‰¹å¾ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹ã€‚</p>
<p>åº”ç”¨åœºæ™¯ï¼šæ–‡æœ¬åˆ†ç±»ï¼Œå•è¯ä½œä¸ºç‰¹å¾ã€‚</p>
</blockquote>
<h4 id="å†³ç­–æ ‘"><a href="#å†³ç­–æ ‘" class="headerlink" title="å†³ç­–æ ‘"></a>å†³ç­–æ ‘</h4><p>å“ªä¸ªç‰¹å¾å€¼çš„ä¿¡æ¯å¢ç›Šå¤§ï¼Œé‚£å°±åº”è¯¥å…ˆç”¨è¿™ä¸ªç‰¹å¾å€¼åšè¿‡æ»¤ã€‚</p>
<p>ç¼ºç‚¹ï¼šå®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆï¼Œå³ä¸€ä¸ª overfitted æ¨¡å‹è®°ä½å¤ªå¤š training data çš„ç»†èŠ‚ä»è€Œé™ä½äº† generalization çš„èƒ½åŠ›ã€‚</p>
<blockquote>
<p>æ¬ æ‹Ÿåˆï¼šå…‰çœ‹ä¹¦ä¸åšé¢˜è§‰å¾—è‡ªå·±ä¼šäº†ï¼Œä¸Šäº†è€ƒåœºå•¥éƒ½ä¸ä¼šï¼›<br>è¿‡æ‹Ÿåˆ: åšè¯¾åé¢˜å…¨éƒ½èƒ½åšå¯¹ï¼Œä¸Šäº†è€ƒåœºè¿˜æ˜¯å•¥éƒ½ä¸ä¼šã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier, export_graphviz</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®é›†</span></span><br><span class="line">iris = load_iris()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†³ç­–æ ‘é¢„ä¼°å™¨</span></span><br><span class="line">estimator = DecisionTreeClassifier(criterion=<span class="string">"entropy"</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="comment"># ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"y_predict:\n"</span>, y_predict)</span><br><span class="line">print(<span class="string">"ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n"</span>, y_test == y_predict)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">score = estimator.score(x_test, y_test)</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š\n"</span>, score)</span><br><span class="line"></span><br><span class="line"><span class="string">"""ç»“æœæ‰“å°</span></span><br><span class="line"><span class="string">y_predict:</span></span><br><span class="line"><span class="string"> [0 2 1 2 1 1 1 1 1 0 2 1 2 2 0 2 1 1 1 1 0 2 0 1 2 0 2 2 2 1 0 0 1 1 1 0 0</span></span><br><span class="line"><span class="string"> 0]</span></span><br><span class="line"><span class="string">ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:</span></span><br><span class="line"><span class="string"> [ True  True  True  True  True  True  True False  True  True  True  True</span></span><br><span class="line"><span class="string">  True  True  True  True  True  True False  True  True  True  True  True</span></span><br><span class="line"><span class="string">  True  True  True  True  True False  True  True  True  True  True  True</span></span><br><span class="line"><span class="string">  True  True]</span></span><br><span class="line"><span class="string">å‡†ç¡®ç‡ä¸ºï¼š</span></span><br><span class="line"><span class="string"> 0.9210526315789473</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–å†³ç­–æ ‘</span></span><br><span class="line">export_graphviz(estimator, out_file=<span class="string">"iris_tree.dot"</span>, feature_names=iris.feature_names)</span><br></pre></td></tr></table></figure>

<p><a href="https://dreampuf.github.io/GraphvizOnline/" target="_blank" rel="noopener">åœ¨çº¿å¯è§†åŒ–</a></p>
<img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/DecisionTree.png" style="zoom:50%;" />

<h4 id="éšæœºæ£®æ—"><a href="#éšæœºæ£®æ—" class="headerlink" title="éšæœºæ£®æ—"></a>éšæœºæ£®æ—</h4><blockquote>
<p>æ£®æ—ï¼šåŒ…å«å¤šä¸ªå†³ç­–æ ‘çš„åˆ†ç±»å™¨ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®åŒå†³ç­–æ ‘</span></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨éšæœºæ£®æ—</span></span><br><span class="line">estimator = RandomForestClassifier()</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(estimator.score(x_test, y_test))</span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹åˆ†æï¼šç­¾åˆ°é¢„æµ‹"><a href="#æ¡ˆä¾‹åˆ†æï¼šç­¾åˆ°é¢„æµ‹" class="headerlink" title="æ¡ˆä¾‹åˆ†æï¼šç­¾åˆ°é¢„æµ‹"></a>æ¡ˆä¾‹åˆ†æï¼šç­¾åˆ°é¢„æµ‹</h3><blockquote>
<p>æ ¹æ®ç»™å®šçš„æ•°æ®ï¼Œé¢„æµ‹äººä»¬æœ€å¯èƒ½åœ¨åœ°å›¾ä¸Šçš„å“ªä¸ªä½ç½®è¿›è¡Œç­¾åˆ°ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">data = pd.read_csv(<span class="string">"./FBlocation/train.csv"</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Facebook.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼©å°èŒƒå›´ï¼Œæ–¹ä¾¿å®éªŒ</span></span><br><span class="line">data = data.query(<span class="string">"x &lt; 2.5 &amp; x &gt; 2 &amp; y &lt; 1.5 &amp; y &gt; 1.0"</span>)</span><br><span class="line"><span class="comment"># å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè¿™ä¸ªæ—¶é—´çœ‹çš„å¾ˆéš¾å—</span></span><br><span class="line"><span class="comment"># æ—¶é—´å¤„ç†æˆä¾¿äºè§‚å¯Ÿçš„å½¢å¼</span></span><br><span class="line">time_value = pd.to_datetime(data[<span class="string">"time"</span>], unit=<span class="string">"s"</span>)</span><br><span class="line">time_value.head()</span><br><span class="line"><span class="comment"># å¹´æœˆçš„å·®åˆ«ä¸å¤§ï¼Œå¯ä¸è€ƒè™‘</span></span><br><span class="line"><span class="string">"""ç»“æœæ‰“å°</span></span><br><span class="line"><span class="string">112    1970-01-08 05:06:14</span></span><br><span class="line"><span class="string">180    1970-01-08 01:29:55</span></span><br><span class="line"><span class="string">367    1970-01-07 17:01:07</span></span><br><span class="line"><span class="string">874    1970-01-02 15:52:46</span></span><br><span class="line"><span class="string">1022   1970-01-03 09:46:33</span></span><br><span class="line"><span class="string">Name: time, dtype: datetime64[ns]</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># å¾—åˆ°æ—¶é—´åˆ—</span></span><br><span class="line">date = pd.DatetimeIndex(time_value)</span><br><span class="line"><span class="comment"># ç»™æ•°æ®å¢åŠ æ—¥æœŸï¼Œæ˜ŸæœŸï¼Œæ—¶é—´è¿™äº›ç‰¹å¾å€¼</span></span><br><span class="line">data[<span class="string">"day"</span>] = date.day</span><br><span class="line">data[<span class="string">"weekday"</span>] = date.weekday</span><br><span class="line">data[<span class="string">"hour"</span>] = date.hour</span><br></pre></td></tr></table></figure>

<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Facebook01.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ® place_id æˆç»„ï¼Œè¿‡æ»¤ç­¾åˆ°æ¬¡æ•°æ¯”è¾ƒå°‘çš„åœ°ç‚¹</span></span><br><span class="line">place_count = data.groupby(<span class="string">"place_id"</span>).count()[<span class="string">"row_id"</span>]</span><br></pre></td></tr></table></figure>

<p><img src="http://welab-wingo.gitee.io/image/2020/04/SKlearn/Facebook02.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿‡æ»¤</span></span><br><span class="line">place_count[place_count &gt; <span class="number">3</span>].head()</span><br><span class="line"><span class="comment"># æ ¹æ®å¾—åˆ°çš„ place_id å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">data_final = data[data[<span class="string">"place_id"</span>].isin(place_count[place_count &gt; <span class="number">3</span>].index.values)]</span><br><span class="line"><span class="comment"># ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼</span></span><br><span class="line">x = data_final[[<span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"accuracy"</span>, <span class="string">"day"</span>, <span class="string">"weekday"</span>, <span class="string">"hour"</span>]]</span><br><span class="line">y = data_final[<span class="string">"place_id"</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®é›†åˆ’åˆ†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‰¹å¾å·¥ç¨‹ï¼šæ ‡å‡†åŒ–</span></span><br><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># KNN ç®—æ³•é¢„ä¼°å™¨</span></span><br><span class="line">estimator = KNeighborsClassifier()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ å…¥ç½‘æ ¼æœç´¢ä¸äº¤å‰éªŒè¯</span></span><br><span class="line"><span class="comment"># å‚æ•°å‡†å¤‡</span></span><br><span class="line">param_dict = &#123;<span class="string">"n_neighbors"</span>: [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]&#125;</span><br><span class="line">estimator = GridSearchCV(estimator, param_grid=param_dict, cv=<span class="number">3</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line"><span class="comment"># ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"y_predict:\n"</span>, y_predict)</span><br><span class="line">print(<span class="string">"ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n"</span>, y_test == y_predict)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">score = estimator.score(x_test, y_test)</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š\n"</span>, score)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€ä½³å‚æ•°ï¼šbest_params_</span></span><br><span class="line">print(<span class="string">"æœ€ä½³å‚æ•°ï¼š\n"</span>, estimator.best_params_)</span><br><span class="line"><span class="comment"># æœ€ä½³ç»“æœï¼šbest_score_</span></span><br><span class="line">print(<span class="string">"æœ€ä½³ç»“æœï¼š\n"</span>, estimator.best_score_)</span><br><span class="line"><span class="comment"># æœ€ä½³ä¼°è®¡å™¨ï¼šbest_estimator_</span></span><br><span class="line">print(<span class="string">"æœ€ä½³ä¼°è®¡å™¨:\n"</span>, estimator.best_estimator_)</span><br><span class="line"><span class="comment"># äº¤å‰éªŒè¯ç»“æœï¼šcv_results_</span></span><br><span class="line">print(<span class="string">"äº¤å‰éªŒè¯ç»“æœ:\n"</span>, estimator.cv_results_)</span><br></pre></td></tr></table></figure>

<h3 id="æ¡ˆä¾‹åˆ†æï¼šç”Ÿå­˜é¢„æµ‹"><a href="#æ¡ˆä¾‹åˆ†æï¼šç”Ÿå­˜é¢„æµ‹" class="headerlink" title="æ¡ˆä¾‹åˆ†æï¼šç”Ÿå­˜é¢„æµ‹"></a>æ¡ˆä¾‹åˆ†æï¼šç”Ÿå­˜é¢„æµ‹</h3><blockquote>
<p>æ ¹æ®äººçš„ä¿¡æ¯é¢„æµ‹æ­¤äººåœ¨æ­¤ç¾éš¾ä¸­å­˜æ´»ä¸‹æ¥çš„æ¦‚ç‡ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">titanic = pd.read_csv(<span class="string">"titanic.csv"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼</span></span><br><span class="line">x = titanic[[<span class="string">"pclass"</span>, <span class="string">"age"</span>, <span class="string">"sex"</span>]]</span><br><span class="line">y = titanic[<span class="string">"survived"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼ºå¤±å€¼å¤„ç†</span></span><br><span class="line">x[<span class="string">"age"</span>].fillna(x[<span class="string">"age"</span>].mean(), inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬æ¢æˆå­—å…¸ï¼Œæ–¹ä¾¿å¤„ç†</span></span><br><span class="line">x = x.to_dict(orient=<span class="string">"records"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="comment"># æ•°æ®é›†åˆ’åˆ†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x, y, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—å…¸ç‰¹å¾æŠ½å–</span></span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction <span class="keyword">import</span> DictVectorizer</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"></span><br><span class="line">transfer = DictVectorizer()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„ä¼°å™¨</span></span><br><span class="line">estimator = DecisionTreeClassifier(criterion=<span class="string">"entropy"</span>, max_depth=<span class="number">3</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"y_predict:\n"</span>, y_predict)</span><br><span class="line">print(<span class="string">"ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n"</span>, y_test == y_predict)</span><br><span class="line"></span><br><span class="line">score = estimator.score(x_test, y_test)</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š\n"</span>, score)</span><br></pre></td></tr></table></figure>

<h3 id="å›å½’ç®—æ³•"><a href="#å›å½’ç®—æ³•" class="headerlink" title="å›å½’ç®—æ³•"></a>å›å½’ç®—æ³•</h3><h4 id="çº¿æ€§å›å½’"><a href="#çº¿æ€§å›å½’" class="headerlink" title="çº¿æ€§å›å½’"></a>çº¿æ€§å›å½’</h4><blockquote>
<p>ç›®æ ‡å€¼ä¸ºè¿ç»­æ€§çš„æ•°æ®ã€‚</p>
</blockquote>
<h5 id="æ­£è§„æ–¹ç¨‹"><a href="#æ­£è§„æ–¹ç¨‹" class="headerlink" title="æ­£è§„æ–¹ç¨‹"></a>æ­£è§„æ–¹ç¨‹</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_boston</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­£è§„æ–¹ç¨‹çš„ä¼˜åŒ–æ–¹æ³•å¯¹æ³¢å£«é¡¿æˆ¿ä»·è¿›è¡Œé¢„æµ‹</span></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">boston = load_boston()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(boston.data, boston.target, random_state=<span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡å‡†åŒ–</span></span><br><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„ä¼°å™¨</span></span><br><span class="line">estimator = LinearRegression()</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—å‡ºæ¨¡å‹</span></span><br><span class="line">print(<span class="string">"æ­£è§„æ–¹ç¨‹-æƒé‡ç³»æ•°ä¸ºï¼š\n"</span>, estimator.coef_)</span><br><span class="line">print(<span class="string">"æ­£è§„æ–¹ç¨‹-åç½®ä¸ºï¼š\n"</span>, estimator.intercept_)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"é¢„æµ‹æˆ¿ä»·ï¼š\n"</span>, y_predict)</span><br><span class="line">error = mean_squared_error(y_test, y_predict)</span><br><span class="line">print(<span class="string">"æ­£è§„æ–¹ç¨‹-å‡æ–¹è¯¯å·®ä¸ºï¼š\n"</span>, error)</span><br></pre></td></tr></table></figure>

<h5 id="æ¢¯åº¦ä¸‹é™"><a href="#æ¢¯åº¦ä¸‹é™" class="headerlink" title="æ¢¯åº¦ä¸‹é™"></a>æ¢¯åº¦ä¸‹é™</h5><blockquote>
<p>ä¸€ä¸ªä¸æ–­é€¼è¿‘çš„ï¼Œå‹¤å¥‹åŠªåŠ›çš„ç®—æ³•ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_boston</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> SGDRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–æ–¹æ³•å¯¹æ³¢å£«é¡¿æˆ¿ä»·è¿›è¡Œé¢„æµ‹</span></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">boston = load_boston()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(boston.data, boston.target, random_state=<span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡å‡†åŒ–</span></span><br><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„ä¼°å™¨</span></span><br><span class="line">estimator = SGDRegressor(learning_rate=<span class="string">"constant"</span>, eta0=<span class="number">0.01</span>, max_iter=<span class="number">10000</span>, penalty=<span class="string">"l1"</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—å‡ºæ¨¡å‹</span></span><br><span class="line">print(<span class="string">"æ¢¯åº¦ä¸‹é™-æƒé‡ç³»æ•°ä¸ºï¼š\n"</span>, estimator.coef_)</span><br><span class="line">print(<span class="string">"æ¢¯åº¦ä¸‹é™-åç½®ä¸ºï¼š\n"</span>, estimator.intercept_)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"é¢„æµ‹æˆ¿ä»·ï¼š\n"</span>, y_predict)</span><br><span class="line">error = mean_squared_error(y_test, y_predict)</span><br><span class="line">print(<span class="string">"æ¢¯åº¦ä¸‹é™-å‡æ–¹è¯¯å·®ä¸ºï¼š\n"</span>, error)</span><br></pre></td></tr></table></figure>

<h5 id="å²­å›å½’"><a href="#å²­å›å½’" class="headerlink" title="å²­å›å½’"></a>å²­å›å½’</h5><blockquote>
<p>å¸¦æœ‰ L2 æ­£åˆ™åŒ–çš„çº¿æ€§å›å½’ï¼šå²­å›å½’</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_boston</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Ridge</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢¯åº¦ä¸‹é™çš„ä¼˜åŒ–æ–¹æ³•å¯¹æ³¢å£«é¡¿æˆ¿ä»·è¿›è¡Œé¢„æµ‹</span></span><br><span class="line"><span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">boston = load_boston()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(boston.data, boston.target, random_state=<span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡å‡†åŒ–</span></span><br><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„ä¼°å™¨</span></span><br><span class="line">estimator = Ridge(alpha=<span class="number">0.5</span>, max_iter=<span class="number">10000</span>)</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾—å‡ºæ¨¡å‹</span></span><br><span class="line">print(<span class="string">"å²­å›å½’-æƒé‡ç³»æ•°ä¸ºï¼š\n"</span>, estimator.coef_)</span><br><span class="line">print(<span class="string">"å²­å›å½’-åç½®ä¸ºï¼š\n"</span>, estimator.intercept_)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"é¢„æµ‹æˆ¿ä»·ï¼š\n"</span>, y_predict)</span><br><span class="line">error = mean_squared_error(y_test, y_predict)</span><br><span class="line">print(<span class="string">"å²­å›å½’-å‡æ–¹è¯¯å·®ä¸ºï¼š\n"</span>, error)</span><br></pre></td></tr></table></figure>

<h4 id="é€»è¾‘å›å½’"><a href="#é€»è¾‘å›å½’" class="headerlink" title="é€»è¾‘å›å½’"></a>é€»è¾‘å›å½’</h4><blockquote>
<p>é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰æ˜¯ä¸€ç§ç”¨äºè§£å†³äºŒåˆ†ç±»ï¼ˆ0 or 1ï¼‰é—®é¢˜çš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œç”¨äºä¼°è®¡æŸç§äº‹ç‰©çš„å¯èƒ½æ€§ã€‚</p>
</blockquote>
<h5 id="ç²¾ç¡®ç‡"><a href="#ç²¾ç¡®ç‡" class="headerlink" title="ç²¾ç¡®ç‡"></a>ç²¾ç¡®ç‡</h5><blockquote>
<p>Precision å³ï¼ŒæŸ¥çš„å‡†ä¸å‡†ã€‚</p>
</blockquote>
<h5 id="å¬å›ç‡"><a href="#å¬å›ç‡" class="headerlink" title="å¬å›ç‡"></a>å¬å›ç‡</h5><blockquote>
<p>Recall å³ï¼ŒæŸ¥çš„å…¨ä¸å…¨ã€‚</p>
</blockquote>
<h5 id="F1-score"><a href="#F1-score" class="headerlink" title="F1-score"></a>F1-score</h5><blockquote>
<p>æ¨¡å‹çš„ç¨³å¥æ€§ã€‚</p>
</blockquote>
<h3 id="æ¡ˆä¾‹åˆ†æï¼šè‚¿ç˜¤é¢„æµ‹"><a href="#æ¡ˆä¾‹åˆ†æï¼šè‚¿ç˜¤é¢„æµ‹" class="headerlink" title="æ¡ˆä¾‹åˆ†æï¼šè‚¿ç˜¤é¢„æµ‹"></a>æ¡ˆä¾‹åˆ†æï¼šè‚¿ç˜¤é¢„æµ‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ•°æ®</span></span><br><span class="line">path = <span class="string">"https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.data"</span></span><br><span class="line">column_name = [<span class="string">'Sample code number'</span>, <span class="string">'Clump Thickness'</span>, <span class="string">'Uniformity of Cell Size'</span>, <span class="string">'Uniformity of Cell Shape'</span>,</span><br><span class="line">                   <span class="string">'Marginal Adhesion'</span>, <span class="string">'Single Epithelial Cell Size'</span>, <span class="string">'Bare Nuclei'</span>, <span class="string">'Bland Chromatin'</span>,</span><br><span class="line">                   <span class="string">'Normal Nucleoli'</span>, <span class="string">'Mitoses'</span>, <span class="string">'Class'</span>]</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(path, names=column_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼ºå¤±å€¼å¤„ç†</span></span><br><span class="line"><span class="comment"># æ›¿æ¢ ã€‹ np.nan</span></span><br><span class="line">data = data.replace(to_replace=<span class="string">"?"</span>, value=np.nan)</span><br><span class="line"><span class="comment"># åˆ é™¤ç¼ºå¤±æ ·æœ¬</span></span><br><span class="line">data.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># æ£€æŸ¥æ˜¯å¦è¿˜å­˜åœ¨ç¼ºå¤±å€¼</span></span><br><span class="line">data.isnull().any()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="comment"># ç­›é€‰ç‰¹å¾å€¼å’Œç›®æ ‡å€¼</span></span><br><span class="line">x = data.iloc[:, <span class="number">1</span>:<span class="number">-1</span>]</span><br><span class="line">y = data[<span class="string">"Class"</span>]</span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x, y, random_state=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># æ ‡å‡†åŒ–</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">transfer = StandardScaler()</span><br><span class="line">x_train = transfer.fit_transform(x_train)</span><br><span class="line">x_test = transfer.transform(x_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€»è¾‘å›å½’é¢„æµ‹</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"></span><br><span class="line">estimator = LogisticRegression()</span><br><span class="line">estimator.fit(x_train, y_train)</span><br><span class="line"><span class="comment"># é€»è¾‘å›å½’çš„æ¨¡å‹å‚æ•°ï¼šå›å½’ç³»æ•°å’Œåç½®</span></span><br><span class="line">print(<span class="string">"é€»è¾‘å›å½’-å›å½’ç³»æ•°ï¼š"</span>, estimator.coef_, <span class="string">"é€»è¾‘å›å½’-åç½®ï¼š"</span> , estimator.intercept_)</span><br><span class="line"></span><br><span class="line">y_predict = estimator.predict(x_test)</span><br><span class="line">print(<span class="string">"y_predict:\n"</span>, y_predict)</span><br><span class="line">print(<span class="string">"ç›´æ¥æ¯”å¯¹çœŸå®å€¼å’Œé¢„æµ‹å€¼:\n"</span>, y_test == y_predict)</span><br><span class="line"></span><br><span class="line">score = estimator.score(x_test, y_test)</span><br><span class="line">print(<span class="string">"å‡†ç¡®ç‡ä¸ºï¼š\n"</span>, score)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1-score</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line">report = classification_report(y_test, y_predict, target_names=[<span class="string">"è‰¯æ€§"</span>, <span class="string">"æ¶æ€§"</span>])</span><br><span class="line"><span class="comment"># y_trueï¼šæ¯ä¸ªæ ·æœ¬çš„çœŸå®ç±»åˆ«ï¼Œå¿…é¡»ä¸º 0 åï¼Œ1 æ­£æ ‡è®°</span></span><br><span class="line"><span class="comment"># å°† y_test è½¬æ¢æˆ 0 1</span></span><br><span class="line">y_true = np.where(y_test &gt; <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score</span><br><span class="line">roc_auc_score(y_true, y_predict)</span><br></pre></td></tr></table></figure>

<h3 id="K-means"><a href="#K-means" class="headerlink" title="K-means"></a>K-means</h3><blockquote>
<p>æ— ç›‘ç£ç®—æ³•ã€‚</p>
</blockquote>
<h4 id="è´­ç‰©è½¦æ¡ˆä¾‹"><a href="#è´­ç‰©è½¦æ¡ˆä¾‹" class="headerlink" title="è´­ç‰©è½¦æ¡ˆä¾‹"></a>è´­ç‰©è½¦æ¡ˆä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># é¢„ä¼°å™¨æµç¨‹</span><br><span class="line">from sklearn.cluster import KMeans</span><br><span class="line"></span><br><span class="line">estimator &#x3D; KMeans(n_clusters&#x3D;3)</span><br><span class="line">estimator.fit(data_new)</span><br><span class="line"></span><br><span class="line">y_predict &#x3D; estimator.predict(data_new)</span><br><span class="line">y_predict[:300]</span><br><span class="line"></span><br><span class="line"># æ¨¡å‹è¯„ä¼°-è½®å»“ç³»æ•°</span><br><span class="line">from sklearn.metrics import silhouette_score</span><br><span class="line">silhouette_score(data_new, y_predict)</span><br></pre></td></tr></table></figure>


        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    æœ€åæ›´æ–°æ—¶é—´ï¼š<time datetime="2020-04-30T03:49:06.999Z" itemprop="dateUpdated">2020-04-30 11:49:06</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/avatar.jpg" alt="Wingo">
            Wingo
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sklearn/" rel="tag">sklearn</a></li></ul>


            


        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/04/25/BigData/Hadoop%20%E5%85%A5%E9%97%A8/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Hadoop å…¥é—¨</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/04/20/Software/RabbitMQ%20%E5%88%9D%E6%AD%A5%E4%BD%BF%E7%94%A8/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">RabbitMQ åˆæ­¥ä½¿ç”¨</h4>
      </a>
    </div>
  
</nav>



    




















</article>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
            <span>å¾—å¤±ä»ç¼˜ï¼Œå¿ƒæ— å¢å‡</span>
        </p>
    </div> 
    <div class="bottom">
        <p><span>Wingo &copy; 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: false, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>










</body>
</html>
